From fa9bd62ce2f0542467d909bc8e5b0310270d8d41 Mon Sep 17 00:00:00 2001
From: Thijs Kinkhorst <thijs@debian.org>
Date: Thu, 5 Dec 2013 14:04:27 +0100
Subject: [PATCH] Update CVE regexp for new CVE format.

From 2014-01-01 CVE id's may have more than 4 digits.

Signed-off-by: Richard Hughes <richard@hughsie.com>
---
 backends/apt/aptBackend.py   |    2 +-
 backends/aptcc/apt-utils.cpp |    2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/backends/apt/aptBackend.py b/backends/apt/aptBackend.py
index 143b4a7..44ef6d3 100755
--- a/backends/apt/aptBackend.py
+++ b/backends/apt/aptBackend.py
@@ -156,7 +156,7 @@ MATCH_BUG_CLOSES_UBUNTU = r"lp:\s+\#\d+(?:,\s*\#\d+)*"
 HREF_BUG_UBUNTU = "https://bugs.launchpad.net/bugs/%s"
 
 # Regular expression to find cve references
-MATCH_CVE="CVE-\d{4}-\d{4}"
+MATCH_CVE="CVE-\d{4}-\d{4,}"
 HREF_CVE="http://web.nvd.nist.gov/view/vuln/detail?vulnId=%s"
 
 SYNAPTIC_PIN_FILE = "/var/lib/synaptic/preferences"
diff --git a/backends/aptcc/apt-utils.cpp b/backends/aptcc/apt-utils.cpp
index d7cefa2..5320794 100644
--- a/backends/aptcc/apt-utils.cpp
+++ b/backends/aptcc/apt-utils.cpp
@@ -267,7 +267,7 @@ GPtrArray* getCVEUrls(const string &changelog)
     // Regular expression to find cve references
     GRegex *regex;
     GMatchInfo *match_info;
-    regex = g_regex_new("CVE-\\d{4}-\\d{4}",
+    regex = g_regex_new("CVE-\\d{4}-\\d{4,}",
                         G_REGEX_CASELESS,
                         G_REGEX_MATCH_NEWLINE_ANY,
                         0);
-- 
1.7.1

